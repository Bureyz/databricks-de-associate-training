flowchart TD
    subgraph TT["Time Travel - Podrozowanie w czasie"]
        TBL["Tabela Delta"] --> V0["Wersja 0"]
        TBL --> V1["Wersja 1"]
        TBL --> V2["Wersja 2"]
        TBL --> VN["Wersja N\n(aktualna)"]

        Q1["SELECT * FROM t\nVERSION AS OF 1"] --> V1
        Q2["SELECT * FROM t\nTIMESTAMP AS OF\n'2024-01-01'"] --> V0
        Q3["DESCRIBE HISTORY t"] --> HIST["Pelna historia\nwszystkich wersji"]
    end

    subgraph VC["VACUUM - Czyszczenie"]
        VN2["Aktualna wersja"] -.- OLD["Stare pliki\nnieaktywne"]
        OLD --> VAC["VACUUM tabela\nRETAIN 168 HOURS"]
        VAC --> DEL["Pliki starsze niz\nretention usuwane"]
        VAC -.->|"UWAGA"| WARN["Po VACUUM\nTime Travel\nniemozliwy\ndla usunietych wersji"]
    end

    style TT fill:#e8f0fe,color:#202124,stroke:#1a73e8,stroke-width:2px
    style VC fill:#fce8e6,color:#202124,stroke:#ea4335,stroke-width:2px
    style V0 fill:#fff,color:#202124,stroke:#1a73e8
    style V1 fill:#fff,color:#202124,stroke:#1a73e8
    style V2 fill:#fff,color:#202124,stroke:#1a73e8
    style VN fill:#34a853,color:#fff,stroke:#1e8e3e
    style VN2 fill:#34a853,color:#fff,stroke:#1e8e3e
    style OLD fill:#fbbc04,color:#202124,stroke:#f9a825
    style DEL fill:#ea4335,color:#fff,stroke:#c5221f
    style WARN fill:#fce8e6,color:#ea4335,stroke:#ea4335
    style HIST fill:#e6f4ea,color:#202124,stroke:#34a853
