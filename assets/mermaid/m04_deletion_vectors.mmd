flowchart TD
    subgraph Traditional["Tradycyjne usuwanie"]
        direction TB
        T1["DELETE WHERE id = 5"] --> T2["Przepisanie calego\npliku Parquet\nbez wiersza id=5"]
        T2 --> T3["Nowy plik\n+ stary usuniety"]
    end

    subgraph DV["Deletion Vectors"]
        direction TB
        D1["DELETE WHERE id = 5"] --> D2["Zapis bitmapy\noznaczajacej wiersz\njako usuniety"]
        D2 --> D3["Oryginalny plik\nniezmieniony\n+ maly plik DV"]
        D3 --> D4["Odczyt filtruje\noznaczone wiersze"]
    end

    Traditional -.- CMP
    DV -.- CMP

    subgraph CMP["Porownanie"]
        C1["Tradycyjne:\nWolny DELETE\nSzybki SELECT"]
        C2["Deletion Vectors:\nSzybki DELETE\nMinimalnie wolniejszy SELECT"]
    end

    style Traditional fill:#fce8e6,color:#202124,stroke:#ea4335,stroke-width:2px
    style DV fill:#e6f4ea,color:#202124,stroke:#34a853,stroke-width:2px
    style CMP fill:#e8f0fe,color:#202124,stroke:#1a73e8,stroke-width:2px
    style T2 fill:#ea4335,color:#fff,stroke:#c5221f
    style D2 fill:#34a853,color:#fff,stroke:#1e8e3e
    style D3 fill:#34a853,color:#fff,stroke:#1e8e3e
