flowchart TD
    subgraph Problem["Problem: Male pliki"]
        direction LR
        F1["1 MB"] 
        F2["2 MB"]
        F3["0.5 MB"]
        F4["1.5 MB"]
        F5["0.3 MB"]
        F6["3 MB"]
        F7["0.8 MB"]
        F8["1.2 MB"]
    end

    Problem -->|"OPTIMIZE tabela"| OPT["Kompaktowanie\nOptimal file size: 1 GB"]

    subgraph Result["Wynik: Zoptymalizowane pliki"]
        direction LR
        R1["~1 GB"]
        R2["~1 GB"]
    end

    OPT --> Result

    Result -->|"OPTIMIZE tabela\nZORDER BY kolumna"| ZO["Z-Ordering\nKolokacja danych\nwedlug kolumny"]

    subgraph ZOrder["Dane posortowane wielowymiarowo"]
        direction LR
        Z1["region=EU\ndate=2024-01"]
        Z2["region=EU\ndate=2024-02"]
        Z3["region=US\ndate=2024-01"]
    end

    ZO --> ZOrder
    ZOrder -->|"Efekt"| SKIP["Data Skipping\nPomijanie nieistotnych plikow\nprzy filtracji"]

    style Problem fill:#fce8e6,color:#202124,stroke:#ea4335,stroke-width:2px
    style Result fill:#e6f4ea,color:#202124,stroke:#34a853,stroke-width:2px
    style ZOrder fill:#e8f0fe,color:#202124,stroke:#1a73e8,stroke-width:2px
    style OPT fill:#fbbc04,color:#202124,stroke:#f9a825,stroke-width:2px
    style ZO fill:#fbbc04,color:#202124,stroke:#f9a825,stroke-width:2px
    style SKIP fill:#34a853,color:#fff,stroke:#1e8e3e,stroke-width:2px
