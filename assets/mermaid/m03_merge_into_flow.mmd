flowchart TD
    SRC["Source Table\nZrodlo danych"] --> MRG["MERGE INTO target\nUSING source\nON condition"]
    MRG --> MATCH{"Czy wiersz\nistnieje w target?"}
    MATCH -->|"MATCHED"| UPD["WHEN MATCHED\nTHEN UPDATE SET ..."]
    MATCH -->|"NOT MATCHED"| INS["WHEN NOT MATCHED\nTHEN INSERT ..."]
    UPD --> TGT["Target Table\nZaktualizowana"]
    INS --> TGT
    
    MATCH -->|"NOT MATCHED\nBY SOURCE"| DEL["WHEN NOT MATCHED\nBY SOURCE\nTHEN DELETE"]
    DEL --> TGT

    style SRC fill:#e8f0fe,color:#202124,stroke:#1a73e8,stroke-width:2px
    style MRG fill:#1a73e8,color:#fff,stroke:#1557b0,stroke-width:2px
    style MATCH fill:#fbbc04,color:#202124,stroke:#f9a825,stroke-width:2px
    style UPD fill:#e6f4ea,color:#202124,stroke:#34a853,stroke-width:2px
    style INS fill:#e6f4ea,color:#202124,stroke:#34a853,stroke-width:2px
    style DEL fill:#fce8e6,color:#202124,stroke:#ea4335,stroke-width:2px
    style TGT fill:#34a853,color:#fff,stroke:#1e8e3e,stroke-width:2px
