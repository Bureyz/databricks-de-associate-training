flowchart LR
    subgraph Enforcement["Schema Enforcement"]
        direction TB
        W1["Zapis danych"] --> CHK{"Czy schemat\nzgodny?"}
        CHK -->|"Tak"| OK1["Zapis zaakceptowany"]
        CHK -->|"Nie"| ERR["BLAD!\nAnalysisException"]
    end

    subgraph Evolution["Schema Evolution"]
        direction TB
        W2["Zapis danych\n+ mergeSchema"] --> ADD{"Nowe\nkolumny?"}
        ADD -->|"Tak"| EV["Schemat rozszerzony\no nowe kolumny"]
        ADD -->|"Nie"| OK2["Zapis bez zmian"]
    end

    Enforcement -.- VS["vs."] -.- Evolution

    style Enforcement fill:#fce8e6,color:#202124,stroke:#ea4335,stroke-width:2px
    style Evolution fill:#e6f4ea,color:#202124,stroke:#34a853,stroke-width:2px
    style ERR fill:#ea4335,color:#fff,stroke:#c5221f
    style OK1 fill:#34a853,color:#fff,stroke:#1e8e3e
    style EV fill:#34a853,color:#fff,stroke:#1e8e3e
    style OK2 fill:#34a853,color:#fff,stroke:#1e8e3e
    style VS fill:none,stroke:none,color:#5f6368
